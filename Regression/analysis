import numpy as np
import pandas as pd
import statsmodels.api as sm

data = pd.read_excel("Metrics Research Project Extracted Data (1).xlsx")

from sklearn.model_selection import train_test_split

X = data.drop("DependentVariable", axis=1)
y = data["DependentVariable"]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25)

model = sm.ols(formula="y ~ X", data=X_train, heteroskedasticity_robust=True)

results = model.fit()

mse = results.mse(X_test, y_test)
print("MSE on test set:", mse)

y_pred = results.predict(X_test)
